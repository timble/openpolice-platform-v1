(function($){if(typeof Joomla==='undefined'){Joomla={}}Joomla.submitbutton=submitbutton=function(button){if(button=="cancelEdit"){try{Joomla.submitform(button)}catch(e){submitform(button)}return}if($jce.Profiles.validate()){$jce.Profiles.onSubmit();try{Joomla.submitform(button)}catch(e){submitform(button)}}};$.jce.Profiles={options:{},init:function(options){var self=this;$.extend(true,this.options,options);if($.browser.msie){$('#jce').addClass('ie')}if(!$.support.cssFloat&&!!window.XMLHttpRequest&&!document.querySelector){$('#jce').addClass('ie7')}$('#tabs').tabs();$('button#user-group-add').button({icons:{primary:'icon-add'}}).click(function(e){e.preventDefault();$('select#types').children().attr('selected',true);return false});$('button#user-group-remove').button({icons:{primary:'icon-remove'}}).click(function(e){e.preventDefault();$('select#types').children(':selected').attr('selected',false);return false});$('button#users-add').button({icons:{primary:'icon-add'}});$('button#users-remove').button({icons:{primary:'icon-remove'}}).click(function(e){e.preventDefault();$('select#users').children(':selected').remove();return false});$('button#layout-legend').button({icons:{primary:'icon-legend'}});$("select.editable, select.combobox").combobox(options.combobox);$("#tabs-editor").tabs().addClass('ui-tabs-vertical ui-helper-clearfix');$("#tabs-plugins").tabs({selected:-1}).addClass('ui-tabs-vertical ui-helper-clearfix');$("#tabs-editor > ul > li, #tabs-plugins #tabs-editor > ul > li").removeClass('ui-corner-top').addClass('ui-corner-left');$("#tabs-plugins").tabs('select',$('ul.ui-tabs-nav > li.ui-state-default:not(.ui-state-disabled):first','#tabs-plugins').index());$('input.color').colorpicker(options.colorpicker);$('select.extensions, input.extensions, textarea.extensions').extensionmapper(options.extensions);this.createLayout();$('select.checklist, input.checklist').checkList();$('input.autocomplete').each(function(){var el=this,v=$(el).attr('placeholder')||'';$(el).removeAttr('placeholder');$(el).autocomplete({source:v.split(',')||[]})});$('input[name="components-select"]').click(function(){$('select#components').attr('disabled',(this.value=='all')).children('option:selected').removeAttr('selected')});$('#paramseditorwidth').change(function(){var v=$(this).val();if(v&&/%/.test(v)){return}else{if(v){v=parseInt(v)}else{v=600}$('span.widthMarker','#profileLayoutTable').width(v).children('span').html(v+'px')}});$('ul#profileAdditionalFeatures input:checkbox').click(function(){self.setPlugins()})},validate:function(){var required=[];$(':input.required').each(function(){if($(this).val()===''){required.push('<li>'+$('label[for="'+this.id+'"]').html()+'</li>')}});if(required.length){var msg='<p>'+$jce.options.labels.required+'</p>';msg+='<ul>';msg+=required.join('');msg+='</ul>';$jce.createDialog({type:'alert',text:msg,modal:true});return false}return true},onSubmit:function(){$('option','#users').prop('selected',true);$('div#tabs-editor, div#tabs-plugins').find(':input[name]').each(function(){if($(this).hasClass('placeholder')){$(this).attr('disabled','disabled')}})},createLayout:function(){var self=this;$("ul.sortableList").sortable({connectWith:'ul.sortableList',axis:'y',tolerance:'intersect',handle:'span.sortableHandle',update:function(event,ui){self.setRows();self.setPlugins()},start:function(event,ui){$(ui.placeholder).width($(ui.item).width())},placeholder:'sortableListItem ui-state-highlight'}).disableSelection();$('span.sortableOption','ul.sortableList li').hover(function(){$(this).append('<span role="button"/>')},function(){$(this).empty()}).click(function(){var $parent=$(this).parent();var $target=$('ul.sortableList','#profileLayoutTable').not($parent.parent());$parent.hide().appendTo($target).show('slow');$(this).empty();self.setRows();self.setPlugins()});$('ul.sortableRow').sortable({connectWith:'ul.sortableRow',tolerance:'intersect',update:function(event,ui){self.setRows();self.setPlugins()},start:function(event,ui){$(ui.placeholder).width($(ui.item).width())},placeholder:'sortableRowItem ui-state-highlight'}).disableSelection()},setRows:function(){var rows=[];$('ul.sortableRow:has(li)','#profileLayout').each(function(){rows.push($.map($('li.sortableRowItem',$(this)),function(el){if($(el).hasClass('spacer')){return'spacer'}return $(el).data('name')}).join(','))});$('input[name="rows"]').val(rows.join(';'))},setPlugins:function(){var self=this,plugins=[];$('ul.sortableRow li.plugin','#profileLayout').each(function(){plugins.push($(this).data('name'))});$('ul#profileAdditionalFeatures input:checkbox:checked').each(function(){plugins.push($(this).val())});$('input[name="plugins"]').val(plugins.join(','));self.setParams(plugins)},setParams:function(plugins){var $tabs=$('div#tabs-plugins');$('div.ui-tabs-panel','div#tabs-plugins').each(function(i){var name=$(this).data('name');var s=$.inArray(name,plugins)!=-1;$(':input[name]',$(this)).prop('disabled',!s);if(!s){if($tabs.tabs('option','selected')==i){var n=0,x=$tabs.tabs('option','disabled');while(i==n){n++;if($.inArray(n,x)!=-1){n++}}$tabs.tabs('select',n)}$tabs.tabs('disable',i)}else{$tabs.tabs('enable',i)}})}}})(jQuery);